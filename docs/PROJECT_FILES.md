# Project Files Generated by Claude Context

This document describes all files and directories that Claude Context creates in your indexed projects and globally.

---

## ğŸ“‚ In Your Indexed Project Directory

Claude Context creates a `.context/` directory in each indexed project:

```
your-project/
â”œâ”€â”€ .context/                     # Claude Context metadata and cache
â”‚   â”œâ”€â”€ project.json             # Project metadata (commit to git âœ…)
â”‚   â””â”€â”€ file-hashes.json         # Incremental indexing cache (gitignored âŒ)
â”œâ”€â”€ src/
â”œâ”€â”€ package.json
â””â”€â”€ ...
```

### `.context/project.json` ğŸ“‹ **Team Shareable**

**Purpose**: Stores project-level metadata for team collaboration

**Created**: Automatically on first successful index

**Structure**:
```json
{
  "version": "1.0",
  "projectPath": "/absolute/path/to/project",
  "collectionName": "hybrid_code_chunks_abc123",
  "gitRepoIdentifier": "github.com/owner/repo",
  "isHybrid": true,
  "embeddingModel": "OpenAI",
  "embeddingDimension": 2048,
  "createdAt": 1704067200000,
  "lastIndexed": 1704067200000,
  "indexedFileCount": 1250,
  "totalChunks": 45000
}
```

**Key Fields**:
- `collectionName`: The vector database collection name (most important!)
- `embeddingModel`: Model used for embeddings
- `embeddingDimension`: Vector dimension
- `isHybrid`: Whether hybrid search (dense + sparse) is enabled

**Size**: < 1 KB (tiny!)

**Lifecycle**:
- Created on first successful index
- Updated after each successful indexing
- Deleted when collection is cleared with `--clean`

**Git Tracking**:
- âœ… **SHOULD be committed** - Contains team-shareable configuration
- Allows team members to use the same collection name
- Essential for consistent vector database naming
- Added to `.gitignore` with exception: `!.context/project.json`

**Team Benefits**:
- Everyone uses the same `collectionName`
- No need to manually synchronize collection names
- Easier to share indexed projects
- Configuration validation (warns if local settings differ)

---

### `.context/file-hashes.json` ğŸ”’ **Local Only**

**Purpose**: Stores file-level hashes for incremental indexing

**Created**: When you first index a project with incremental indexing enabled

**Structure**:
```json
{
  "projectPath": "/absolute/path/to/project",
  "collectionName": "hybrid_code_chunks_abc123",
  "lastIndexed": 1704067200000,
  "files": {
    "src/index.ts": {
      "hash": "sha256_hash_of_file_content",
      "lastModified": 1704067200000,
      "chunkCount": 15
    },
    "src/utils.ts": {
      "hash": "sha256_hash_of_file_content",
      "lastModified": 1704067100000,
      "chunkCount": 8
    }
  }
}
```

**Size**: Typically 10-100 KB for medium projects (scales linearly with file count)

**Lifecycle**:
- Created on first index (or when incremental indexing is enabled)
- Updated after each successful indexing
- Automatically deleted when you run `--clean` flag
- Deleted when collection is dropped (via interactive mode `drop` command)

**Git Tracking**:
- âŒ **Should be ignored** - Already in `.gitignore`
- This is local cache data specific to your environment
- Each developer maintains their own hash cache

---

## ğŸ  Global User Directory

Claude Context also creates a global directory in your home folder:

```
~/.context/                              # Linux/macOS
C:\Users\{username}\.context\            # Windows

â”œâ”€â”€ .env                                 # Global configuration (optional)
â”œâ”€â”€ .contextignore                       # Global ignore patterns (optional)
â”œâ”€â”€ mcp-codebase-snapshot.json          # Project indexing metadata
â”œâ”€â”€ logs/                                # Indexing operation logs
â”‚   â”œâ”€â”€ index-project1-2024-01-15.log
â”‚   â”œâ”€â”€ index-project2-2024-01-15.log
â”‚   â””â”€â”€ ...
â””â”€â”€ merkle/                              # File synchronization merkle trees
    â”œâ”€â”€ project1_merkle.json
    â”œâ”€â”€ project2_merkle.json
    â””â”€â”€ ...
```

### `~/.context/.env`
**Purpose**: Global configuration file (optional)
**Contains**: Embedding API keys, vector database credentials, preferences
**Created**: Manually by user or via setup wizard

### `~/.context/.contextignore`
**Purpose**: Global ignore patterns that apply to all projects
**Created**: Manually by user
**Example**:
```
# Global patterns
*.secret
*.backup
temp/**
```

### `~/.context/mcp-codebase-snapshot.json`
**Purpose**: Tracks all indexed projects and their metadata
**Structure**:
```json
{
  "codebases": {
    "/absolute/path/to/project1": {
      "collectionName": "hybrid_code_chunks_abc123",
      "lastIndexed": 1704067200000,
      "fileCount": 1250,
      "status": "indexed"
    }
  }
}
```

### `~/.context/logs/`
**Purpose**: Detailed indexing operation logs
**Created**: Automatically during indexing
**Retention**: Auto-cleaned after 7 days (configurable)
**Format**: `index-{project-name}-{timestamp}.log`

### `~/.context/merkle/`
**Purpose**: File synchronization merkle trees for change detection
**Created**: Automatically during indexing
**Used by**: `reindexByChange` feature for detecting file changes

---

## ğŸ§¹ Cleanup and Management

### Manual Cleanup

**Remove project-specific cache:**
```bash
# From your project directory
rm -rf .context/
```

**Remove all global data:**
```bash
# Linux/macOS
rm -rf ~/.context/

# Windows
rmdir /s %USERPROFILE%\.context
```

### Automatic Cleanup

**Project cache is automatically cleared when:**
- Running with `--clean` flag: `npm run index:project /path/to/project --clean`
- Using interactive mode `drop` command
- Calling `clearIndex()` API

**Logs are automatically cleaned:**
- Files older than 7 days are removed
- Run manually: `npm run logs:clean`

---

## ğŸ“Š Disk Space Usage

Typical disk space requirements:

| Component | Size | Notes |
|-----------|------|-------|
| `.context/file-hashes.json` | 10-100 KB | Scales with file count (~80 bytes per file) |
| `~/.context/mcp-codebase-snapshot.json` | < 10 KB | One entry per indexed project |
| `~/.context/logs/` | 1-10 MB | Depends on indexing frequency |
| `~/.context/merkle/` | 100 KB - 1 MB | Scales with project size |
| **Total** | **< 20 MB** | For typical usage with 5-10 projects |

---

## ğŸ”’ Privacy & Security

### What's Stored Locally

âœ… **File hashes** (SHA256) - No actual code content
âœ… **File paths** - Relative paths within your project
âœ… **Metadata** - File sizes, chunk counts, timestamps
âœ… **Configuration** - API keys, database credentials

âŒ **NOT stored**: Your actual source code is never written to disk by Claude Context

### What's Sent to External Services

When indexing, the following data is sent to external services:

1. **Embedding Provider** (OpenAI, Alibaba Cloud, etc.)
   - File content chunks for embedding generation
   - Controlled by `EMBEDDING_PROVIDER` and `OPENAI_API_KEY` settings

2. **Vector Database** (Milvus/Zilliz Cloud)
   - Code chunks with embeddings
   - File paths and metadata
   - Controlled by `MILVUS_ADDRESS` and `MILVUS_TOKEN` settings

### Security Recommendations

1. **Add `.context/` to your `.gitignore`** âœ… (already done)
2. **Never commit** `~/.context/.env` or share API keys
3. **Use environment-specific configs** for team projects
4. **Review** `.contextignore` patterns to exclude sensitive files
5. **Consider local embedding models** (Ollama) for sensitive codebases

---

## ğŸ”§ Configuration

### Disable Project-Level Cache

To disable incremental indexing and avoid creating `.context/` directories:

```bash
# .env
INCREMENTAL_INDEX=false
```

This will:
- Skip creating `.context/` in projects
- Force full reindex every time
- Increase embedding costs but simplify deployment

### Custom Cache Location (Future Feature)

Currently not supported, but planned for v0.4.0:

```bash
# .env (future)
CACHE_DIR=/custom/path/to/cache
```

---

## â“ FAQ

**Q: Should I commit `.context/` to git?**
A: **Partially** - Commit `project.json` (contains collection name), but NOT `file-hashes.json` (local cache).

**Q: Why commit `project.json`?**
A: So team members use the same vector database collection name automatically. This prevents confusion and duplicate collections.

**Q: Can I delete `.context/` safely?**
A: Yes, but you'll need to re-index. If you delete `project.json`, a new collection name will be generated.

**Q: How do I move a project to a new location?**
A: Just move it! `project.json` will auto-update the path. The collection name stays the same.

**Q: What happens if my teammate has different embedding settings?**
A: Claude Context will warn you about mismatches (model, dimension, hybrid mode) but will still work.

**Q: Can team members share the same collection?**
A: Yes! That's the point of `project.json`. Everyone points to the same collection in the vector database.

**Q: What if I lose `project.json`?**
A: A new collection name will be generated. You can manually restore it or re-index with `--clean`.

**Q: Does cache affect search results?**
A: No, cache only speeds up indexing. Search results come from the vector database.

**Q: How do I force a new collection name?**
A: Delete `.context/project.json` and run `--clean` to generate a new one.

---

**Last Updated**: January 2025
**Version**: v0.2.3
